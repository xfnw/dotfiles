#!/usr/bin/env python3

import cv2, numpy, mss, sys, time

template = cv2.imread(sys.argv[2])
sct = mss.mss()
monitor = sct.monitors[0]

while True:
    screen = cv2.cvtColor(numpy.array(sct.grab(monitor)), cv2.COLOR_RGBA2RGB)
    res = cv2.matchTemplate(template, screen, cv2.TM_SQDIFF_NORMED)
    v, _, loc, _ = cv2.minMaxLoc(res)

    if v < .1:
        break

    print("waiting...", file=sys.stderr)
    time.sleep(1)

x, y = loc
h, w, _ = template.shape
print(sys.argv[1], x+w//2, y+h//2, *sys.argv[3:])
